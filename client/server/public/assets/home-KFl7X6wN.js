import{u as S,j as e,X as B,r as c,a as f,C as I,b as E,c as v,d as R,e as D,S as L,L as w,T as P,f as T}from"./index-Bl7s4VzA.js";import{C as $,P as q}from"./product-card-C4l0tKkZ.js";import{s as F,D as z,I as A}from"./pwa-utils-3wKQgzN6.js";import{S as H}from"./smartphone-anWcFTs4.js";import{A as K}from"./app-header-Ch0F_p7N.js";import{u as _}from"./use-promo-k7DjY2HR.js";import{C as O}from"./check-BlHW5vLV.js";import{C as Q}from"./copy-BJJ91Hok.js";import"./useMutation-CyJnlrj4.js";import"./dialog-DCOcG2c2.js";import"./index-B7K4-hLV.js";import"./index-1mwFcY8h.js";import"./index-BdQq_4o_.js";import"./badge-B1g9d3Tj.js";import"./bell-BieROCbd.js";function U(){const{showHomeBanner:a,isInstalling:o,handleInstall:h,handleDismissHome:m}=S();return a?e.jsxs("div",{className:"mx-4 mb-4 bg-gradient-to-r from-purple-600 to-purple-700 rounded-xl p-4 text-white shadow-lg relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-10",children:[e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white rounded-full"}),e.jsx("div",{className:"absolute -bottom-2 -left-2 w-16 h-16 bg-white rounded-full"})]}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-lg mr-4",children:e.jsx(H,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –î–£–ß–ê–†–•–ê"}),e.jsx("p",{className:"text-sm text-purple-100 mb-3",children:"–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø —Å –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ ‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω ‚Ä¢ –ë–µ–∑ —Ä–µ–∫–ª–∞–º—ã –±—Ä–∞—É–∑–µ—Ä–∞"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:h,disabled:o,className:"bg-white text-purple-600 px-4 py-2 rounded-lg font-medium text-sm flex items-center gap-2 hover:bg-purple-50 transition-colors disabled:opacity-50","data-testid":"button-install-pwa",children:F()?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4"}),o?"–£—Å—Ç–∞–Ω–æ–≤–∫–∞...":"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4"}),"–ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"]})}),e.jsx("button",{onClick:m,className:"text-purple-100 hover:text-white px-2","data-testid":"button-dismiss-pwa-banner",children:e.jsx(B,{className:"w-5 h-5"})})]})]})]})]}):null}const k="ducharcha_banners_cache",W=()=>{try{const a=localStorage.getItem(k);return a?JSON.parse(a):[]}catch{return[]}},G=a=>{try{localStorage.setItem(k,JSON.stringify(a))}catch{}};function J(){const[a,o]=c.useState(0),[h,m]=c.useState(W()),n=c.useRef(!0),{data:x=[],isLoading:b}=f({queryKey:["/api/banners"],staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!0});c.useEffect(()=>()=>{n.current=!1},[]),c.useEffect(()=>{x.length>0&&n.current&&(G(x),m(x))},[x]);const i=x.length>0?x:h;c.useEffect(()=>{if(i.length<=1)return;const s=setInterval(()=>{n.current&&o(d=>(d+1)%i.length)},7e3);return()=>{clearInterval(s)}},[i.length]);const j=()=>{n.current&&o(s=>s===0?i.length-1:s-1)},u=()=>{n.current&&o(s=>(s+1)%i.length)};if(i.length===0&&b)return e.jsx("section",{className:"text-white p-6 relative overflow-hidden h-[200px] flex items-center mx-4 mt-4 mb-4 rounded-lg bg-[#5B21B6]",children:e.jsx("div",{className:"relative z-10 flex flex-col justify-center h-full py-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-white/20 rounded mb-3 w-3/4"}),e.jsx("div",{className:"h-4 bg-white/10 rounded mb-2 w-full"}),e.jsx("div",{className:"h-4 bg-white/10 rounded w-2/3"})]})})});if(i.length===0)return null;const r=i[a],y=s=>{const d=s||"#6366f1";return{background:`linear-gradient(135deg, ${d} 0%, ${d}dd 100%)`}},p=s=>{switch(s){case"promo":return"üéâ";case"announcement":return"üì¢";case"partnership":return"ü§ù";default:return"üì¢"}};return e.jsxs("section",{className:"text-white p-6 relative overflow-hidden h-[200px] flex items-center mx-4 rounded-lg transition-all duration-700 ease-in-out pt-[24px] pb-[24px] pl-[24px] pr-[24px] mt-[20px] mb-[20px] ml-[0px] mr-[0px]",style:{...y(r.backgroundColor||"#6366f1"),color:r.textColor||"#ffffff"},children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:j,className:"absolute -left-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-full bg-black/30 hover:bg-black/50 transition-colors shadow-lg","aria-label":"–ü—Ä–µ–¥—ã–¥—É—â–∏–π –±–∞–Ω–Ω–µ—Ä",children:e.jsx(I,{className:"w-6 h-6"})}),e.jsx("button",{onClick:u,className:"absolute -right-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-full bg-black/30 hover:bg-black/50 transition-colors shadow-lg","aria-label":"–°–ª–µ–¥—É—é—â–∏–π –±–∞–Ω–Ω–µ—Ä",children:e.jsx(E,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"relative z-10 w-full flex flex-col justify-center h-full py-4 bg-transparent banner-slider-content",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[r.subtitle==="–≠–∫—Å–ø—Ä–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∞"&&r.priority===0&&e.jsxs("div",{className:"delivery-pulse bg-electric-green text-white px-3 py-1 rounded-full text-sm font-semibold mr-3 flex items-center",children:[e.jsx(v,{className:"mr-1 w-4 h-4"}),"10-15 –º–∏–Ω"]}),r.subtitle&&e.jsxs("span",{className:"text-white/80 text-sm",children:[r.subtitle==="–≠–∫—Å–ø—Ä–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∞"&&r.priority===0?"üéâ":"",!(r.subtitle==="–≠–∫—Å–ø—Ä–µ—Å—Å –¥–æ—Å—Ç–∞–≤–∫–∞"&&r.priority===0)&&p(r.type)," ",r.subtitle]})]}),e.jsx("h2",{className:"text-2xl font-bold mb-3 leading-tight",children:r.title}),e.jsx("p",{className:"text-white/90 mb-4 max-w-md leading-relaxed",children:r.message})]}),i.length>1&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-20 mt-[-15px] mb-[-15px]",children:i.map((s,d)=>e.jsx("button",{onClick:()=>o(d),className:`w-2 h-2 rounded-full transition-colors ${d===a?"bg-white":"bg-white/50"}`,"aria-label":`–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–∞–π–¥—É ${d+1}`},d))}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-16 -mt-16 floating-elements"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full -ml-12 -mb-12 floating-elements",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/2 right-1/4 w-16 h-16 bg-white/3 rounded-full floating-elements",style:{animationDelay:"4s"}}),r.priority===0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1/4 left-3/4 w-20 h-20 bg-white/4 rounded-full floating-elements",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-1/4 right-1/2 w-12 h-12 bg-white/3 rounded-full floating-elements",style:{animationDelay:"3s"}})]})]})}function M(a,o){const[h,m]=c.useState(a);return c.useEffect(()=>{const n=setTimeout(()=>{m(a)},o);return()=>{clearTimeout(n)}},[a,o]),h}function xe(){const[a,o]=c.useState(""),[h,m]=c.useState(!1),[n,x]=c.useState(!1),[b,i]=c.useState(new Set);R(),D(),_();const j=async()=>{const t="–ü–ï–†–í–´–ô";try{await navigator.clipboard.writeText(t),m(!0),setTimeout(()=>m(!1),2e3)}catch{const l=document.createElement("textarea");l.value=t,l.style.position="fixed",l.style.top="-9999px",l.style.left="-9999px";try{document.body.appendChild(l),l.focus(),l.select(),document.execCommand("copy")}finally{l.parentNode===document.body&&document.body.removeChild(l)}m(!0),setTimeout(()=>m(!1),2e3)}},{data:u=[],isLoading:r}=f({queryKey:["/api/categories"],staleTime:6e5,refetchInterval:!1}),{data:y=[],isLoading:p}=f({queryKey:["/api/products","popular"],queryFn:()=>fetch("/api/products?popular=true").then(t=>t.json()),staleTime:3e5,refetchInterval:!1,enabled:!0}),s=M(a,300),{data:d=[]}=f({queryKey:["/api/products","search",s],queryFn:()=>fetch(`/api/products?search=${encodeURIComponent(s)}`).then(t=>t.json()),enabled:s.length>0,staleTime:6e4}),C=u.slice(0,4),N=s?d:y;return c.useEffect(()=>{const t=()=>{const g=document.querySelector("#search-section");if(g&&!n)g.getBoundingClientRect().top<=0&&x(!0);else if(n){const l=document.querySelector(".banner-section");l&&l.getBoundingClientRect().bottom>0&&x(!1)}};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[n]),e.jsxs("main",{className:"pb-20 bg-background",children:[e.jsx(K,{showLogo:!0,showNotifications:!0}),e.jsx("div",{className:"banner-section",children:e.jsx(J,{})}),e.jsx(U,{}),e.jsx("div",{id:"search-section",className:`${n?"fixed top-0 left-0 right-0 z-50":"relative"} bg-white dark:bg-card p-4 ${n?"shadow-sm":""}`,children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"–ò—Å–∫–∞—Ç—å –≤ –î–£–ß–ê–†–•–ê",value:a,onChange:t=>o(t.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl text-gray-900 dark:text-gray-100 bg-gray-100 dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-agent-purple/50 focus:bg-white dark:focus:bg-gray-700 transition-all","data-testid":"input-search-products"})]})}),!s&&e.jsx("section",{className:"px-4.5 relative z-20 my-3.5",children:r?e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[1,2,3,4].map(t=>e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-xl h-20 animate-pulse"},t))}):e.jsx("div",{className:"grid grid-cols-4 gap-1",children:C.map(t=>e.jsx($,{category:t},t.id))})}),!s&&e.jsx("section",{className:"p-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-electric-green via-emerald-400 to-teal-400 rounded-xl p-6 text-white relative overflow-hidden card-hover",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"bg-white/20 p-2 rounded-full mr-3",children:e.jsx("div",{className:"text-lg",children:"üéâ"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl mb-1",children:"–°–∫–∏–¥–∫–∞ 20% –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑"}),e.jsxs("p",{className:"text-green-100 text-sm",children:["–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ ",e.jsx("span",{className:"font-semibold bg-white/20 px-2 py-1 rounded",children:"–ü–ï–†–í–´–ô"})," –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏"]})]})]}),e.jsx("button",{onClick:j,className:`flex items-center space-x-2 px-6 py-3 rounded-lg font-semibold text-sm transition-all mt-4 ${h?"bg-green-600 text-white scale-105":"bg-white text-electric-green hover:bg-gray-50 hover:scale-105 active:scale-95"}`,"data-testid":"button-copy-promo",children:h?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 text-white"}),e.jsx("span",{children:"–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥"})]})})]}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full floating-elements"}),e.jsx("div",{className:"absolute -bottom-6 -left-6 w-20 h-20 bg-white/5 rounded-full floating-elements",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/3 right-1/4 w-8 h-8 bg-white/10 rounded-full floating-elements",style:{animationDelay:"3s"}})]})}),e.jsxs("section",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:s?`–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ (${N.length})`:"–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"}),!s&&e.jsx(w,{href:"/catalog",children:e.jsx("button",{className:"text-agent-purple font-medium text-sm",children:"–í—Å–µ —Ç–æ–≤–∞—Ä—ã"})})]}),p||N.length===0?e.jsx("div",{className:"text-center py-8",children:p?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-[#5B21B6]"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤..."})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:s?"–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã":"–¢–æ–≤–∞—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"})}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:N.map(t=>e.jsx(q,{product:t},t.id))})]}),!s&&u.length>4&&e.jsxs("section",{className:"p-4 mt-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4",children:"–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"}),e.jsx("div",{className:"space-y-3",children:u.slice(4).map(t=>e.jsx(w,{href:`/catalog/${t.id}`,children:e.jsxs("button",{className:"w-full bg-white dark:bg-card rounded-xl p-4 shadow-sm flex items-center card-hover",children:[!t.imageUrl||b.has(t.id)?e.jsx("div",{className:"w-12 h-9 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center mr-4",children:e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"üìã"})}):e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-12 h-9 rounded-lg object-cover mr-4",onError:()=>{i(g=>{const l=new Set(g);return l.add(t.id),l})}}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"–®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤"})]}),e.jsx("div",{className:"fas fa-chevron-right text-gray-400 dark:text-gray-500"})]})},t.id))})]}),!s&&e.jsx("section",{className:"p-4 mb-4",children:e.jsxs("div",{className:"bg-white dark:bg-card rounded-xl p-4 shadow-sm card-hover",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-100 mb-3",children:"–£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"bg-agent-purple/10 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(v,{className:"text-agent-purple w-6 h-6"})}),e.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"10-15 –º–∏–Ω—É—Ç"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"bg-electric-green/10 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(P,{className:"text-electric-green w-6 h-6"})}),e.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"–í—Å–µ–≥–¥–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"–ë–µ–∑ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"bg-bright-orange/10 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(T,{className:"text-bright-orange w-6 h-6"})}),e.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-200",children:"–ö–∞—á–µ—Å—Ç–≤–æ"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"–ì–∞—Ä–∞–Ω—Ç–∏—è —Å–≤–µ–∂–µ—Å—Ç–∏"})]})]})]})})]})}export{xe as default};
